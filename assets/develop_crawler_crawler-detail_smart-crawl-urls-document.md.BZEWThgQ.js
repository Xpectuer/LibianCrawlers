import{_ as a,c as i,o as e,a3 as l}from"./chunks/framework.w8luOYmq.js";const c=JSON.parse('{"title":"详解 smart-crawl-urls 脚本","description":"","frontmatter":{},"headers":[],"relativePath":"develop/crawler/crawler-detail/smart-crawl-urls-document.md","filePath":"develop/crawler/crawler-detail/smart-crawl-urls-document.md","lastUpdated":1762687402000}'),n={name:"develop/crawler/crawler-detail/smart-crawl-urls-document.md"};function t(r,s,h,p,d,k){return e(),i("div",null,s[0]||(s[0]=[l(`<h1 id="详解-smart-crawl-urls-脚本" tabindex="-1">详解 smart-crawl-urls 脚本 <a class="header-anchor" href="#详解-smart-crawl-urls-脚本" aria-label="Permalink to &quot;详解 smart-crawl-urls 脚本&quot;">​</a></h1><p>smart-crawl-urls 脚本的功能是遍历 url 列表，并传给 <a href="./smart-crawl-document.html#url">smart-crawl 的 url 参数</a> 的子进程命令行参数。 然后一个一个进行爬取。</p><p>其除了以下 <a href="#自身特有的命令行参数">自身特有的命令行参数</a> 外的其他参数都会被传给 <a href="./smart-crawl-document.html#命令行启动参数文档">smart-crawl 的命令行参数</a>。</p><h2 id="自身特有的命令行参数" tabindex="-1">自身特有的命令行参数 <a class="header-anchor" href="#自身特有的命令行参数" aria-label="Permalink to &quot;自身特有的命令行参数&quot;">​</a></h2><h3 id="keys" tabindex="-1">keys <a class="header-anchor" href="#keys" aria-label="Permalink to &quot;keys&quot;">​</a></h3><p><code>--keys &lt;source&gt;</code> 必填。传入列表信息。</p><blockquote><p>TODO: source 格式介绍</p></blockquote><h3 id="key2url-jsfunc" tabindex="-1">key2url_jsfunc <a class="header-anchor" href="#key2url-jsfunc" aria-label="Permalink to &quot;key2url_jsfunc&quot;">​</a></h3><p><code>--key2url_jsfunc &lt;js_function_string&gt;</code> 可选。传入一个 javascript 函数（仅支持 es5 语法），将读取到的 keys 列表使用此函数进行 Mapping 输出。</p><h3 id="retry-count-default" tabindex="-1">retry_count_default <a class="header-anchor" href="#retry-count-default" aria-label="Permalink to &quot;retry_count_default&quot;">​</a></h3><p><code>--retry_count_default &lt;number&gt;</code> 可选。重试次数。默认值为 <code>5</code>。</p><h3 id="retry-always" tabindex="-1">retry_always <a class="header-anchor" href="#retry-always" aria-label="Permalink to &quot;retry_always&quot;">​</a></h3><p><code>--retry_always</code> 可选。启用此选项后，在重试次数用尽后，不会退出进程，而是弹出 <code>gui_confirm</code> 窗口，当程序员确认此窗口后重置重试次数并继续重试。</p><h2 id="示例-wos-journal-期刊信息查询" tabindex="-1">示例 wos-journal 期刊信息查询 <a class="header-anchor" href="#示例-wos-journal-期刊信息查询" aria-label="Permalink to &quot;示例 wos-journal 期刊信息查询&quot;">​</a></h2><p>第一步，同时启动查询 <code>data_cleaner_ci/user_code/</code> 符号链接目录下的 <code>journals_need_search/</code> 目录下的:</p><ul><li><code>issn.json</code></li><li><code>eissn.json</code></li><li><code>journal_name.json</code></li></ul><p>并将查询结果保存到数据库和结果文件。</p><blockquote><p>这些文件是由 data_cleaner_ci 清洗后的再通过其他脚本联表合并的。</p></blockquote><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-eEuKy" id="tab--ETUBLG" checked><label data-title="查询 issn" for="tab--ETUBLG">查询 issn</label><input type="radio" name="group-eEuKy" id="tab-pkqt1lg"><label data-title="查询 eissn" for="tab-pkqt1lg">查询 eissn</label><input type="radio" name="group-eEuKy" id="tab-AGxsNtI"><label data-title="查询 journal_name" for="tab-AGxsNtI">查询 journal_name</label></div><div class="blocks"><div class="language-shell vp-adaptive-theme active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">poetry</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> smart-crawl-urls</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --screen_max_height</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --key2url_jsfunc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;function(k){return &#39;https://wos-journal.info/?jsearch=&#39;+k.split(&#39; &#39;).join(&#39;+&#39;)}&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --locale</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zh-CN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --screen_max_height</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --retry_always</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --keys</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;jsonfile:data_cleaner_ci/user_code/journals_need_search/issn.json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --browser_data_dir_id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no_trace_wos_journal_1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --mode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">poetry</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> smart-crawl-urls</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --screen_max_height</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --key2url_jsfunc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;function(k){return &#39;https://wos-journal.info/?jsearch=&#39;+k.split(&#39; &#39;).join(&#39;+&#39;)}&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --locale</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zh-CN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --screen_max_height</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --retry_always</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --keys</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;jsonfile:data_cleaner_ci/user_code/journals_need_search/eissn.json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --browser_data_dir_id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no_trace_wos_journal_2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --mode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">poetry</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> smart-crawl-urls</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --screen_max_height</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --key2url_jsfunc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;function(k){return &#39;https://wos-journal.info/?jsearch=&#39;+k.split(&#39; &#39;).join(&#39;+&#39;)}&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --locale</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zh-CN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --screen_max_height</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --retry_always</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --keys</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;jsonfile:data_cleaner_ci/user_code/journals_need_search/journal_name.json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --browser_data_dir_id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no_trace_wos_journal_3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --mode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></div></div><p>（此功能尚实现）在完成期刊信息查询后，将已经查过的那三个文件复制为 <code>*.already.json</code> 后缀。</p><p>下次爬取时将会过滤掉这些已经查过的 keys。</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data_cleaner_ci/user_code/journals_need_search/issn.json</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data_cleaner_ci/user_code/journals_need_search/issn.already.json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data_cleaner_ci/user_code/journals_need_search/eissn.json</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data_cleaner_ci/user_code/journals_need_search/eissn.already.json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data_cleaner_ci/user_code/journals_need_search/journal_name.json</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data_cleaner_ci/user_code/journals_need_search/journal_name.already.json</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div>`,22)]))}const u=a(n,[["render",t]]);export{c as __pageData,u as default};
